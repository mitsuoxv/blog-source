{"title":"My first pull request: imfr","markdown":{"yaml":{"title":"My first pull request: imfr","author":"Mitsuo Shiota","date":"2020-10-28","date-modified":"2023-06-15","categories":["economics","R"],"knitr":{"opts_chunk":{"out.width":"70%"}}},"headingText":"My first pull request","containsRefs":false,"markdown":"\n\nI changed code to work under `imfr` Version 2.\n\n\n[Package 'imfr'](https://github.com/christophergandrud/imfr) is the first package which merged my very small pull request. Thank you, creator Christopher Gandrud. I would like to show a usage example below.\n\n```{r}\n#| label: setup\n#| message: false\n\nlibrary(tidyverse)\nlibrary(imfr)\n\ntheme_set(theme_light())\n```\n\n## Look for database ID\n\nPackage 'imfr' provides some functions to help us explore IMF database. First, I use 'imf_databases' function to get database IDs.\n\n```{r}\n#| label: databases\n\nimf_app_name(\"mitsuoxv\")\n\ndatabases <- imf_databases()\n```\n\nThere are `r nrow(databases)` databases. I get a dataframe with 2 columns, 'database_id' and 'description'.\n\n```{r}\n#| label: head_databases\n\nhead(databases)\n```\n\nI transform 'description' into all lower characters, in order to make search easier.\n\n```{r}\n#| label: description_to_lower\n\ndatabases <- databases |> \n  mutate(description = str_to_lower(description))\n```\n\nAs I am interested in debt issues, I search 'debt' in 'description'. I get 'database_id' HPDD, of which 'description' is historical public debt.\n\n```{r}\n#| label: detect_debt\n\ndatabases |> \n  filter(str_detect(description, \"debt\"))\n```\n\n## Retrieve parameters of a database\n\nI use 'imf_parameters' function to retrieve the parameters of the database whose id is HPDD.\n\n```{r}\n#| label: params\n\nparams <- imf_parameters(\"HPDD\")\n\nstr(params)\n```\n\nThere are 3 lists of code and description:\n\n1. frequency,\n1. geographical areas (code: two-letter country codes defined in ISO 3166-1), and\n1. indicator. Here, I get only one indicator GGXWDG_GDP, which describes Debt to GDP Ratio.\n\n## Download data\n\nNow I am ready to download data. I use 'imf_dataset' function. I specify HPDD as 'database_id', select 'freq', 'ref_area' and 'indicator' from the parameters, and set 'start_year' and 'end_year'.\n\n```{r}\n#| label: download\n\ndebt_gdp_ratio <- imf_dataset(\n  database_id = \"HPDD\",\n  freq = \"A\",\n  ref_area = params$ref_area$input_code,\n  indicator = \"GGXWDG_GDP\",\n  start_year = 1700, end_year = 2020\n)\n```\n\nI change 'year' from character to integer, and add 'country' by utilizing the 2nd list.\n\n```{r}\n#| label: make_pretty\n\ndebt_gdp_ratio <- debt_gdp_ratio |> \n  as_tibble() |> \n  mutate(across(date:value, as.numeric)) |> \n  select(date:ref_area) |> \n  left_join(params$ref_area, by = c(\"ref_area\"=\"input_code\")) |> \n  rename(country = description)\n\nhead(debt_gdp_ratio)\n```\n\nSome countries have data as old as 1800. They are U.K., U.S. and Sweden. Most recent year is 2015.\n\n```{r}\n#| label: year_range\n\nrange(debt_gdp_ratio$date)\n```\n\n```{r}\n#| label: countries_1800\n\ndebt_gdp_ratio |>  \n  filter(date == 1800)\n```\n\n`r unique(debt_gdp_ratio$country) |>  length()` countries have some data.\n\n## A chart and some thoughts\n\nI use [countrycode.org](https://countrycode.org/) to get two-letter code of the select countries, and draw a chart.\n\nDebt to GDP ratio rises in the war, and, if you win, it decreases thanks to growth and inflation. If you lose, it decreases thanks to some defaults and very high inflation. Some people in the losing side lose their financial wealth, but most misery does not come from debt, but from physical devastation.\n\nRecently it rises due to secular stagnation, in which monetary policy is constrained by zero lower bound of nominal interest rates, and full employment can be achieved only by bubble or expansionary fiscal policy.\n\n```{r}\n#| label: fig-line_chart\n#| fig-cap: Debt to GDP Ratio in Japan, the US, the UK and Zimbabwe\n#| fig-align: center\n\ndebt_gdp_ratio %>% \n  filter(ref_area %in% c(\"US\", \"GB\", \"JP\", \"ZW\")) %>% \n  ggplot(aes(date, value, color = fct_reorder2(country, date, value))) +\n  geom_line(linewidth = 1) +\n  labs(x = NULL, y = \"Debt to GDP Ratio\",\n       color = \"counry\")\n```\n\nDebt to GDP ratio reflects the government capacity to borrow, the household and the enterprise capacity to save, and the financial sector capacity to mediate. It melts, if nominal GDP growth rates are higher than nominal interest rates.\n\nIf Japan falls into deflation, nominal GDP growth rates are negative, and nominal interest rates are zero due to lower bound. This leads to ballooning debt to GDP ratios. Austerity is not the solution, as it leads to deeper deflation and under-employment. Coordinating and rebalancing the monetary and fiscal policies is the solution, which can make inflation expectation positive and well anchored.\n","srcMarkdownNoYaml":"\n\nI changed code to work under `imfr` Version 2.\n\n## My first pull request\n\n[Package 'imfr'](https://github.com/christophergandrud/imfr) is the first package which merged my very small pull request. Thank you, creator Christopher Gandrud. I would like to show a usage example below.\n\n```{r}\n#| label: setup\n#| message: false\n\nlibrary(tidyverse)\nlibrary(imfr)\n\ntheme_set(theme_light())\n```\n\n## Look for database ID\n\nPackage 'imfr' provides some functions to help us explore IMF database. First, I use 'imf_databases' function to get database IDs.\n\n```{r}\n#| label: databases\n\nimf_app_name(\"mitsuoxv\")\n\ndatabases <- imf_databases()\n```\n\nThere are `r nrow(databases)` databases. I get a dataframe with 2 columns, 'database_id' and 'description'.\n\n```{r}\n#| label: head_databases\n\nhead(databases)\n```\n\nI transform 'description' into all lower characters, in order to make search easier.\n\n```{r}\n#| label: description_to_lower\n\ndatabases <- databases |> \n  mutate(description = str_to_lower(description))\n```\n\nAs I am interested in debt issues, I search 'debt' in 'description'. I get 'database_id' HPDD, of which 'description' is historical public debt.\n\n```{r}\n#| label: detect_debt\n\ndatabases |> \n  filter(str_detect(description, \"debt\"))\n```\n\n## Retrieve parameters of a database\n\nI use 'imf_parameters' function to retrieve the parameters of the database whose id is HPDD.\n\n```{r}\n#| label: params\n\nparams <- imf_parameters(\"HPDD\")\n\nstr(params)\n```\n\nThere are 3 lists of code and description:\n\n1. frequency,\n1. geographical areas (code: two-letter country codes defined in ISO 3166-1), and\n1. indicator. Here, I get only one indicator GGXWDG_GDP, which describes Debt to GDP Ratio.\n\n## Download data\n\nNow I am ready to download data. I use 'imf_dataset' function. I specify HPDD as 'database_id', select 'freq', 'ref_area' and 'indicator' from the parameters, and set 'start_year' and 'end_year'.\n\n```{r}\n#| label: download\n\ndebt_gdp_ratio <- imf_dataset(\n  database_id = \"HPDD\",\n  freq = \"A\",\n  ref_area = params$ref_area$input_code,\n  indicator = \"GGXWDG_GDP\",\n  start_year = 1700, end_year = 2020\n)\n```\n\nI change 'year' from character to integer, and add 'country' by utilizing the 2nd list.\n\n```{r}\n#| label: make_pretty\n\ndebt_gdp_ratio <- debt_gdp_ratio |> \n  as_tibble() |> \n  mutate(across(date:value, as.numeric)) |> \n  select(date:ref_area) |> \n  left_join(params$ref_area, by = c(\"ref_area\"=\"input_code\")) |> \n  rename(country = description)\n\nhead(debt_gdp_ratio)\n```\n\nSome countries have data as old as 1800. They are U.K., U.S. and Sweden. Most recent year is 2015.\n\n```{r}\n#| label: year_range\n\nrange(debt_gdp_ratio$date)\n```\n\n```{r}\n#| label: countries_1800\n\ndebt_gdp_ratio |>  \n  filter(date == 1800)\n```\n\n`r unique(debt_gdp_ratio$country) |>  length()` countries have some data.\n\n## A chart and some thoughts\n\nI use [countrycode.org](https://countrycode.org/) to get two-letter code of the select countries, and draw a chart.\n\nDebt to GDP ratio rises in the war, and, if you win, it decreases thanks to growth and inflation. If you lose, it decreases thanks to some defaults and very high inflation. Some people in the losing side lose their financial wealth, but most misery does not come from debt, but from physical devastation.\n\nRecently it rises due to secular stagnation, in which monetary policy is constrained by zero lower bound of nominal interest rates, and full employment can be achieved only by bubble or expansionary fiscal policy.\n\n```{r}\n#| label: fig-line_chart\n#| fig-cap: Debt to GDP Ratio in Japan, the US, the UK and Zimbabwe\n#| fig-align: center\n\ndebt_gdp_ratio %>% \n  filter(ref_area %in% c(\"US\", \"GB\", \"JP\", \"ZW\")) %>% \n  ggplot(aes(date, value, color = fct_reorder2(country, date, value))) +\n  geom_line(linewidth = 1) +\n  labs(x = NULL, y = \"Debt to GDP Ratio\",\n       color = \"counry\")\n```\n\nDebt to GDP ratio reflects the government capacity to borrow, the household and the enterprise capacity to save, and the financial sector capacity to mediate. It melts, if nominal GDP growth rates are higher than nominal interest rates.\n\nIf Japan falls into deflation, nominal GDP growth rates are negative, and nominal interest rates are zero due to lower bound. This leads to ballooning debt to GDP ratios. Austerity is not the solution, as it leads to deeper deflation and under-employment. Coordinating and rebalancing the monetary and fiscal policies is the solution, which can make inflation expectation positive and well anchored.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":6,"fig-height":3.708,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"source","theme":"cosmo","title-block-banner":true,"title":"My first pull request: imfr","author":"Mitsuo Shiota","date":"2020-10-28","date-modified":"2023-06-15","categories":["economics","R"],"knitr":{"opts_chunk":{"out.width":"70%"}}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}