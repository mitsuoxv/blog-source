{"title":"Update: let POTUS speak","markdown":{"yaml":{"title":"Update: let POTUS speak","author":"Mitsuo Shiota","date":"2020-07-17","categories":["economics","Python","tensorflow"]},"headingText":"I have finished manually cleaned up text files from 1947 to 2020","containsRefs":false,"markdown":"\n\n\nI put the cleaned-up files in `texts/presidents/` of [this GitHub repo](https://github.com/mitsuoxv/erp). I name a file as `1947_pres.txt`. These files include only texts of the president part, not including those of the Council of Economic Advisers part.\n\nI cleaned up by:\n\n1. correcting word order, where digitization made mistakes in shaping lines;\n\n1. correcting words, where optical recognition made mistakes due to dirt, or the author apparently misspelled;\n\n1. making punctuation common over reports, following my memory of [\"The Mac is Not a Typewriter\" by Robin P. Williams](https://www.goodreads.com/book/show/41600.The_Mac_is_Not_a_Typewriter), which I must have, but could not find now. As an exception, using minus mark instead of hyphen; and\n\n1. changing lines, where I encounter \";\", \":\", \"—\" or \",\" and when I feel changed lines are natural if they were in President Johnson's reports.\n\nI tried to be consistent over reports of different authors. Honestly, I am not sure whether \"text\" has become more consistent or not, as a result.\n\n## I tried Google Colab, but failed\n\nThe file in [the same repository](https://github.com/mitsuoxv/erp),  [let_pres_speak_failed.ipynb](https://github.com/mitsuoxv/erp/blob/master/let_pres_speak_failed.ipynb), is my failed attempt to use Google Colab to create a model.\n\nIt timed out at 186th among 500 epochs.\n\n## I tried docker, struggled with an error of dnn implementation, and eventually found a solution\n\nSo I came back to docker, and tried tensorflow 2.3.0rc1, hoping newer version had fixed the errors.\n\n```\ndocker run -u $(id -u):$(id -g) \\\n  --gpus all -it -p 8888:8888 -v `pwd`:/tf/notebooks \\\n  tensorflow/tensorflow:2.3.0rc1-gpu-jupyter\n```\n\nHowever, I encountered the same problem of dnn implementation. I searched and found [tensorflow: Fail to find dnn implementation](https://stackoverflow.com/questions/56333388/tensorflow-fail-to-find-dnn-implementation) in StackOverflow. I added the lines:\n\n```\nfrom tensorflow.compat.v1 import ConfigProto\nfrom tensorflow.compat.v1 import InteractiveSession\nconfig = ConfigProto()\nconfig.gpu_options.allow_growth = True\nsession = InteractiveSession(config=config)\n```\n\nAnd it worked! To allow GPU grow was the key.\n\n## I created a model, and generated a text\n\nThe file in [the same repository](https://github.com/mitsuoxv/erp),  [let_em_speak_retry.ipynb](https://github.com/mitsuoxv/erp/blob/master/let_em_speak_retry.ipynb), is the result I've got.\n\nTo my surprise, docker working in [my machine](https://mitsuoxv.rbind.io/2020/05/31/i-built-a-pc-installed-pop-os-and-am-running-rstudio/) was 4 times faster than Google Colab. It took approximately 8 hours.\n\nThen I seeded the text, \"I have some proposals to the Congress\". The model continued:\n\n\"of the first months of the past year have been accomplished to keep that matter up their abundance ending upon the war ii and hearts inflation continues to adjust peoples testifies nor paperwork proposals know moreover coverage to assures visible in our economic destabilizing coverage overregulated that skillfully assures we beef destabilizing coverage under coverage implies antitrust destabilizing fiscally testify to approve urban coverage coverage coverage and stymies consumption authorities dividend coverage appropriated coverage reaching else coverage propose proposals propose proposals stymies preference loans continued values meant that urgent coverage downward know coverage fostered that referred sdr disease coverage for\"\n\nGrammar is not correct, and the word \"coverage\" appears repeatedly. However, some sets of words sound natural, as the model guesses next word after word.\n\n## You can try\n\nAlthough this model has no practical use, I have saved it as \"ErpPresModel.h5\". You can play with it, by opening [you_can_try.ipynb](https://github.com/mitsuoxv/erp/blob/master/you_can_try.ipynb) in Google Colab.\n","srcMarkdownNoYaml":"\n\n## I have finished manually cleaned up text files from 1947 to 2020\n\nI put the cleaned-up files in `texts/presidents/` of [this GitHub repo](https://github.com/mitsuoxv/erp). I name a file as `1947_pres.txt`. These files include only texts of the president part, not including those of the Council of Economic Advisers part.\n\nI cleaned up by:\n\n1. correcting word order, where digitization made mistakes in shaping lines;\n\n1. correcting words, where optical recognition made mistakes due to dirt, or the author apparently misspelled;\n\n1. making punctuation common over reports, following my memory of [\"The Mac is Not a Typewriter\" by Robin P. Williams](https://www.goodreads.com/book/show/41600.The_Mac_is_Not_a_Typewriter), which I must have, but could not find now. As an exception, using minus mark instead of hyphen; and\n\n1. changing lines, where I encounter \";\", \":\", \"—\" or \",\" and when I feel changed lines are natural if they were in President Johnson's reports.\n\nI tried to be consistent over reports of different authors. Honestly, I am not sure whether \"text\" has become more consistent or not, as a result.\n\n## I tried Google Colab, but failed\n\nThe file in [the same repository](https://github.com/mitsuoxv/erp),  [let_pres_speak_failed.ipynb](https://github.com/mitsuoxv/erp/blob/master/let_pres_speak_failed.ipynb), is my failed attempt to use Google Colab to create a model.\n\nIt timed out at 186th among 500 epochs.\n\n## I tried docker, struggled with an error of dnn implementation, and eventually found a solution\n\nSo I came back to docker, and tried tensorflow 2.3.0rc1, hoping newer version had fixed the errors.\n\n```\ndocker run -u $(id -u):$(id -g) \\\n  --gpus all -it -p 8888:8888 -v `pwd`:/tf/notebooks \\\n  tensorflow/tensorflow:2.3.0rc1-gpu-jupyter\n```\n\nHowever, I encountered the same problem of dnn implementation. I searched and found [tensorflow: Fail to find dnn implementation](https://stackoverflow.com/questions/56333388/tensorflow-fail-to-find-dnn-implementation) in StackOverflow. I added the lines:\n\n```\nfrom tensorflow.compat.v1 import ConfigProto\nfrom tensorflow.compat.v1 import InteractiveSession\nconfig = ConfigProto()\nconfig.gpu_options.allow_growth = True\nsession = InteractiveSession(config=config)\n```\n\nAnd it worked! To allow GPU grow was the key.\n\n## I created a model, and generated a text\n\nThe file in [the same repository](https://github.com/mitsuoxv/erp),  [let_em_speak_retry.ipynb](https://github.com/mitsuoxv/erp/blob/master/let_em_speak_retry.ipynb), is the result I've got.\n\nTo my surprise, docker working in [my machine](https://mitsuoxv.rbind.io/2020/05/31/i-built-a-pc-installed-pop-os-and-am-running-rstudio/) was 4 times faster than Google Colab. It took approximately 8 hours.\n\nThen I seeded the text, \"I have some proposals to the Congress\". The model continued:\n\n\"of the first months of the past year have been accomplished to keep that matter up their abundance ending upon the war ii and hearts inflation continues to adjust peoples testifies nor paperwork proposals know moreover coverage to assures visible in our economic destabilizing coverage overregulated that skillfully assures we beef destabilizing coverage under coverage implies antitrust destabilizing fiscally testify to approve urban coverage coverage coverage and stymies consumption authorities dividend coverage appropriated coverage reaching else coverage propose proposals propose proposals stymies preference loans continued values meant that urgent coverage downward know coverage fostered that referred sdr disease coverage for\"\n\nGrammar is not correct, and the word \"coverage\" appears repeatedly. However, some sets of words sound natural, as the model guesses next word after word.\n\n## You can try\n\nAlthough this model has no practical use, I have saved it as \"ErpPresModel.h5\". You can play with it, by opening [you_can_try.ipynb](https://github.com/mitsuoxv/erp/blob/master/you_can_try.ipynb) in Google Colab.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":6,"fig-height":3.708,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"source","theme":"cosmo","title-block-banner":true,"title":"Update: let POTUS speak","author":"Mitsuo Shiota","date":"2020-07-17","categories":["economics","Python","tensorflow"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}