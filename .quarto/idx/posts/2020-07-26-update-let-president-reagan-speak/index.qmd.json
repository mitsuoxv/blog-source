{"title":"Update: let President Reagan speak","markdown":{"yaml":{"title":"Update: let President Reagan speak","author":"Mitsuo Shiota","date":"2020-07-26","categories":["economics","Python","tensorflow"]},"headingText":"OpenAI's GPT-2 model","containsRefs":false,"markdown":"\n\n\nIn June 2020, OpenAI released GPT-3, a new text generator. Its reputation is very high. However, I can't try it, because its size with 175 billion parameters is huge, and I can't access [OpenAI API](https://openai.com/blog/openai-api/).\n\nSo I looked around for information about an old one, GPT-2. I found [gpt-2-simple module by Max Woolf](https://github.com/minimaxir/gpt-2-simple), and decided to try it.\n\n## I use reports from 1982 to 1989 by President Reagan\n\nI combined reports from 1982 to 1989 into reagan.txt.\n\n## I tried docker, but failed due to ResourceExhaustedError\n\nAs gpt-2-simple module requires tensorflow 1.14 or 15, I create docker like below.\n\n```\ndocker run -u $(id -u):$(id -g) \\\n  --gpus all -it -p 8888:8888 -v `pwd`:/tf/notebooks \\\n  tensorflow/tensorflow:1.15.2-gpu-py3-jupyter\n```\n\nI tried the smallest model, \"124M\", in [gpt-2-try-and-error.ipynb](https://github.com/mitsuoxv/erp/blob/master/gpt-2-try-and-error.ipynb), but failed due to ResourceExhaustedError. Probably my machine's GPU VRAM 6GB is not enough.\n\n## I tried Google Colab, and got an annoying result\n\nIn [the previous post](https://mitsuoxv.rbind.io/posts/2020-07-17-update-let-potus-speak/), my trial in Google Colab failed due to time out. In the retrospect, I may have forgotten to enable GPU by Edit > Notebook settings. This time I enabled GPU. It took about one and half hour to finetune the model. The result is [gpt_2_colab.ipynb](https://github.com/mitsuoxv/erp/blob/master/gpt_2_colab.ipynb).\n\nI seeded the text, \"I have some proposals to the Congress.\" The finetuned model continued:\n\n\"One way or the other, we will pursue the issues that matter most to us—jobs, growth, and economic opportunity—that will lead to sustained economic growth and to free trade and international economic cooperation.\"\n\nAfter that, it copied the lines from #240 to #284 of the input texts, reagan.txt, I used for finetuning. Is it overfitting? I don't know.\n","srcMarkdownNoYaml":"\n\n## OpenAI's GPT-2 model\n\nIn June 2020, OpenAI released GPT-3, a new text generator. Its reputation is very high. However, I can't try it, because its size with 175 billion parameters is huge, and I can't access [OpenAI API](https://openai.com/blog/openai-api/).\n\nSo I looked around for information about an old one, GPT-2. I found [gpt-2-simple module by Max Woolf](https://github.com/minimaxir/gpt-2-simple), and decided to try it.\n\n## I use reports from 1982 to 1989 by President Reagan\n\nI combined reports from 1982 to 1989 into reagan.txt.\n\n## I tried docker, but failed due to ResourceExhaustedError\n\nAs gpt-2-simple module requires tensorflow 1.14 or 15, I create docker like below.\n\n```\ndocker run -u $(id -u):$(id -g) \\\n  --gpus all -it -p 8888:8888 -v `pwd`:/tf/notebooks \\\n  tensorflow/tensorflow:1.15.2-gpu-py3-jupyter\n```\n\nI tried the smallest model, \"124M\", in [gpt-2-try-and-error.ipynb](https://github.com/mitsuoxv/erp/blob/master/gpt-2-try-and-error.ipynb), but failed due to ResourceExhaustedError. Probably my machine's GPU VRAM 6GB is not enough.\n\n## I tried Google Colab, and got an annoying result\n\nIn [the previous post](https://mitsuoxv.rbind.io/posts/2020-07-17-update-let-potus-speak/), my trial in Google Colab failed due to time out. In the retrospect, I may have forgotten to enable GPU by Edit > Notebook settings. This time I enabled GPU. It took about one and half hour to finetune the model. The result is [gpt_2_colab.ipynb](https://github.com/mitsuoxv/erp/blob/master/gpt_2_colab.ipynb).\n\nI seeded the text, \"I have some proposals to the Congress.\" The finetuned model continued:\n\n\"One way or the other, we will pursue the issues that matter most to us—jobs, growth, and economic opportunity—that will lead to sustained economic growth and to free trade and international economic cooperation.\"\n\nAfter that, it copied the lines from #240 to #284 of the input texts, reagan.txt, I used for finetuning. Is it overfitting? I don't know.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":6,"fig-height":3.708,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"source","theme":"cosmo","title-block-banner":true,"title":"Update: let President Reagan speak","author":"Mitsuo Shiota","date":"2020-07-26","categories":["economics","Python","tensorflow"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}