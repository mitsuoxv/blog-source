{
  "hash": "109625995bdcedd2bd7614d0e7ec44a8",
  "result": {
    "markdown": "---\ntitle: 'My first pull request: imfr'\nauthor: Mitsuo Shiota\ndate: '2020-10-28'\ndate-modified:  '2023-06-15'\ncategories:\n  - economics\n  - R\nknitr: \n  opts_chunk: \n    out.width: '70%'\n---\n\n\nI changed code to work under `imfr` Version 2.\n\n## My first pull request\n\n[Package 'imfr'](https://github.com/christophergandrud/imfr) is the first package which merged my very small pull request. Thank you, creator Christopher Gandrud. I would like to show a usage example below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(imfr)\n\ntheme_set(theme_light())\n```\n:::\n\n\n## Look for database ID\n\nPackage 'imfr' provides some functions to help us explore IMF database. First, I use 'imf_databases' function to get database IDs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimf_app_name(\"mitsuoxv\")\n\ndatabases <- imf_databases()\n```\n:::\n\n\nThere are 323 databases. I get a dataframe with 2 columns, 'database_id' and 'description'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(databases)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  database_id\n1 BOP_2017M06\n2  BOP_2020M3\n3 BOP_2017M11\n4  DOT_2020Q1\n5  GFSMAB2016\n6 BOP_2019M12\n                                                                       description\n1                                              Balance of Payments (BOP), 2017 M06\n2                                              Balance of Payments (BOP), 2020 M03\n3                                              Balance of Payments (BOP), 2017 M11\n4                                    Direction of Trade Statistics (DOTS), 2020 Q1\n5 Government Finance Statistics Yearbook (GFSY 2016), Main Aggregates and Balances\n6                                              Balance of Payments (BOP), 2019 M12\n```\n:::\n:::\n\n\nI transform 'description' into all lower characters, in order to make search easier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatabases <- databases |> \n  mutate(description = str_to_lower(description))\n```\n:::\n\n\nAs I am interested in debt issues, I search 'debt' in 'description'. I get 'database_id' HPDD, of which 'description' is historical public debt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatabases |> \n  filter(str_detect(description, \"debt\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  database_id                   description\n1        HPDD historical public debt (hpdd)\n```\n:::\n:::\n\n\n## Retrieve parameters of a database\n\nI use 'imf_parameters' function to retrieve the parameters of the database whose id is HPDD.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparams <- imf_parameters(\"HPDD\")\n\nstr(params)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 3\n $ freq     :'data.frame':\t3 obs. of  2 variables:\n  ..$ input_code : chr [1:3] \"A\" \"M\" \"Q\"\n  ..$ description: chr [1:3] \"Annual\" \"Monthly\" \"Quarterly\"\n $ ref_area :'data.frame':\t199 obs. of  2 variables:\n  ..$ input_code : chr [1:199] \"AF\" \"AL\" \"DZ\" \"AO\" ...\n  ..$ description: chr [1:199] \"Afghanistan\" \"Albania\" \"Algeria\" \"Angola\" ...\n $ indicator:'data.frame':\t1 obs. of  2 variables:\n  ..$ input_code : chr \"GGXWDG_GDP\"\n  ..$ description: chr \"Debt to GDP Ratio\"\n```\n:::\n:::\n\n\nThere are 3 lists of code and description:\n\n1. frequency,\n1. geographical areas (code: two-letter country codes defined in ISO 3166-1), and\n1. indicator. Here, I get only one indicator GGXWDG_GDP, which describes Debt to GDP Ratio.\n\n## Download data\n\nNow I am ready to download data. I use 'imf_dataset' function. I specify HPDD as 'database_id', select 'freq', 'ref_area' and 'indicator' from the parameters, and set 'start_year' and 'end_year'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_gdp_ratio <- imf_dataset(\n  database_id = \"HPDD\",\n  freq = \"A\",\n  ref_area = params$ref_area$input_code,\n  indicator = \"GGXWDG_GDP\",\n  start_year = 1700, end_year = 2020\n)\n```\n:::\n\n\nI change 'year' from character to integer, and add 'country' by utilizing the 2nd list.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_gdp_ratio <- debt_gdp_ratio |> \n  as_tibble() |> \n  mutate(across(date:value, as.numeric)) |> \n  select(date:ref_area) |> \n  left_join(params$ref_area, by = c(\"ref_area\"=\"input_code\")) |> \n  rename(country = description)\n\nhead(debt_gdp_ratio)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n   date value freq  ref_area country\n  <dbl> <dbl> <chr> <chr>    <chr>  \n1  1994  85.2 A     AL       Albania\n2  1995  75.0 A     AL       Albania\n3  1996  76.7 A     AL       Albania\n4  1997  81.9 A     AL       Albania\n5  1998  71.9 A     AL       Albania\n6  1999  63.9 A     AL       Albania\n```\n:::\n:::\n\n\nSome countries have data as old as 1800. They are U.K., U.S. and Sweden. Most recent year is 2015.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrange(debt_gdp_ratio$date)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1800 2015\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndebt_gdp_ratio |>  \n  filter(date == 1800)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n   date value freq  ref_area country       \n  <dbl> <dbl> <chr> <chr>    <chr>         \n1  1800  34.3 A     SE       Sweden        \n2  1800 177.  A     GB       United Kingdom\n3  1800  18.1 A     US       United States \n```\n:::\n:::\n\n\n191 countries have some data.\n\n## A chart and some thoughts\n\nI use [countrycode.org](https://countrycode.org/) to get two-letter code of the select countries, and draw a chart.\n\nDebt to GDP ratio rises in the war, and, if you win, it decreases thanks to growth and inflation. If you lose, it decreases thanks to some defaults and very high inflation. Some people in the losing side lose their financial wealth, but most misery does not come from debt, but from physical devastation.\n\nRecently it rises due to secular stagnation, in which monetary policy is constrained by zero lower bound of nominal interest rates, and full employment can be achieved only by bubble or expansionary fiscal policy.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndebt_gdp_ratio %>% \n  filter(ref_area %in% c(\"US\", \"GB\", \"JP\", \"ZW\")) %>% \n  ggplot(aes(date, value, color = fct_reorder2(country, date, value))) +\n  geom_line(linewidth = 1) +\n  labs(x = NULL, y = \"Debt to GDP Ratio\",\n       color = \"counry\")\n```\n\n::: {.cell-output-display}\n![Debt to GDP Ratio in Japan, the US, the UK and Zimbabwe](index_files/figure-html/fig-line_chart-1.png){#fig-line_chart fig-align='center' width=70%}\n:::\n:::\n\n\nDebt to GDP ratio reflects the government capacity to borrow, the household and the enterprise capacity to save, and the financial sector capacity to mediate. It melts, if nominal GDP growth rates are higher than nominal interest rates.\n\nIf Japan falls into deflation, nominal GDP growth rates are negative, and nominal interest rates are zero due to lower bound. This leads to ballooning debt to GDP ratios. Austerity is not the solution, as it leads to deeper deflation and under-employment. Coordinating and rebalancing the monetary and fiscal policies is the solution, which can make inflation expectation positive and well anchored.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}